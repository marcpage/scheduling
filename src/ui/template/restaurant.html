<html>
<body>
<h1>{{ restaurant.name }}</h1>

    {% if user.admin %}

        <a href="/logout">logout</a><br/>
        General Manager: {{ restaurant.gm }}

        <form action="/restaurant/{{ restaurant.id }}/set_gm" method="POST">
            <select name="gm_id">
                {% for user in user_list %}
                    <option value="{{ user.id }}"
                        {% if restaurant.gm
                            and restaurant.gm.id == user.id%} selected{% endif %}>{{ user.name }} ({{ user.email }})</li>
                {% endfor %}
            </select>
            <input type="submit" value="set"/>
        </form>

    {% elif user.id == restaurant.gm_id %}

        <a href="/logout">logout</a><br/>
        Welcome, {{ user.name }}

        <h2>Roles</h2>
        <ul>
        {% for role in restaurant.roles %}
            <li>{{ role.name }}</li>
        {% endfor %}
        </ul>
        <form action="/restaurant/{{ restaurant.id }}/add_role" method="POST">
            <input name="name"
                    type="text"
                    minlength=3
                    placeholder="Role"
                    size=10
                    title="Name of the role"
                    requred autofocus />
            <input type="submit" value="add"/>
        </form>
    {% elif user %}

        <a href="/logout">logout</a><br/>
        Welcome, {{ user.name }}. You have been invited to join our team.

        Add user to restaurant

    {% else %}

        Welcome, you have been invited to join the {{ restaurant.name }} family.
        <form action="/create_user" method="POST">
            <input name="name"
                    type="text"
                    minlength=5
                    placeholder="first and last name"
                    size=25
                    title="your name"
                    requred autofocus /><br/>
            <input name="email"
                    type="text"
                    minlength=5
                    placeholder="email address"
                    size=25
                    pattern="[^@ \t\r\n]+@[^@]+\.[^@]+"
                    title="your email address"
                    requred /><br/>
            <input name="password"
                    type="password"
                    minlength=5
                    placeholder="password"
                    size=25
                    title="your password"
                    requred />
            <input type="hidden" name="restaurant_id" value="{{ restaurant.id }}"/>
            <input type="submit" value="join"/>
        </form>

    {% endif %}

</body>
</html>
